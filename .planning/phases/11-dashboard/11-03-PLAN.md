---
phase: 11-dashboard
plan: 03
type: execute
wave: 3
depends_on: ["11-02"]
files_modified:
  - templates/pages/admin/dashboard.templ
autonomous: false

must_haves:
  truths:
    - "Dashboard shows document stats with clickable navigation"
    - "Dashboard shows processing stats with health badge"
    - "Dashboard shows source stats with status indicators"
    - "All stat cards navigate to relevant detail pages"
    - "Quick actions are present in each section"
  artifacts:
    - path: "templates/pages/admin/dashboard.templ"
      provides: "Three-section dashboard template"
      contains: "DashboardData"
  key_links:
    - from: "templates/pages/admin/dashboard.templ"
      to: "internal/handler/admin.go"
      via: "templ Dashboard(data handler.DashboardData)"
      pattern: "handler\\.DashboardData"
    - from: "templates/pages/admin/dashboard.templ"
      to: "/documents"
      via: "href navigation"
      pattern: "href=\"/documents\""
    - from: "templates/pages/admin/dashboard.templ"
      to: "/queues"
      via: "href navigation"
      pattern: "href=\"/queues\""
---

<objective>
Create the dashboard template with three domain sections, clickable stat cards, and quick actions.

Purpose: Replace placeholder dashboard with functional operations console showing system status at a glance.
Output: Full dashboard template implementing all CONTEXT.md decisions.
</objective>

<execution_context>
@/home/bjk/.claude/get-shit-done/workflows/execute-plan.md
@/home/bjk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/11-dashboard/11-CONTEXT.md
@.planning/phases/11-dashboard/11-RESEARCH.md
@.planning/phases/11-dashboard/11-02-SUMMARY.md
@internal/handler/admin.go
@templates/pages/admin/dashboard.templ
@templates/pages/admin/queue_dashboard.templ
@components/card/card.templ
@components/badge/badge.templ
@components/button/button.templ
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard template with three sections</name>
  <files>templates/pages/admin/dashboard.templ</files>
  <action>
Replace `templates/pages/admin/dashboard.templ` completely with a new dashboard that:

1. **Imports and signature:**
```go
package admin

import (
    "strconv"

    "docko/components/badge"
    "docko/components/button"
    "docko/components/card"
    "docko/components/table"
    "docko/internal/database/sqlc"
    "docko/internal/handler"
    "docko/internal/meta"
    "docko/templates/layouts"
)

templ Dashboard(data handler.DashboardData) {
```

2. **Layout structure with Admin layout:**
```templ
@layouts.Admin(meta.New("Dashboard", "System overview and status")) {
    <div class="space-y-8">
        <div class="mb-4">
            <h1 class="text-2xl font-bold">Dashboard</h1>
            <p class="text-muted-foreground">System overview and status</p>
        </div>
        @documentsSection(data)
        @processingSection(data)
        @sourcesSection(data)
    </div>
}
```

3. **Documents section template:**
- Section header: "Documents" clickable link to /documents with "View all" link
- Card grid (4 columns on lg, 2 on md, 1 on mobile)
- Stat cards:
  - Total Documents -> /documents
  - Processed (green text) -> /documents?status=completed
  - Pending -> /documents?status=pending
  - Failed (destructive text if > 0) -> /documents?status=failed
  - Uploaded Today -> /documents (no filter)
  - Tags -> /tags
  - Correspondents -> /correspondents
- Quick action: Upload button -> /upload

4. **Processing section template:**
- Section header: "Processing" clickable link to /queues with "View all" link
- Health badge next to section header (healthy/warning/issues)
- Stat cards:
  - Queue Pending -> /queues
  - Queue Processing -> /queues
  - Queue Completed -> /queues
  - Queue Failed (destructive if > 0) -> /queues
  - AI Suggestions Pending (highlight if > 0) -> /ai/review
  - Jobs Today -> /queues
- Recent activity table (5 items): queue, type, status badge, time
- Active provider displayed as text: "AI Provider: {name}"

5. **Sources section template:**
- Section header: "Sources" with "View all" links
- Card grid (2 columns)
- Inbox card with:
  - Total/Enabled with status dot (green for enabled > 0, gray otherwise)
  - Link to /inboxes
  - Quick action: Add Inbox button -> /inboxes/new
- Network Sources card with:
  - Total/Enabled with status dot
  - Link to /network-sources
  - Quick action: Sync Now (if any enabled) -> POST /network-sources/sync-all

6. **Helper components:**
- `clickableStatCard(title, value, href, icon templ.Component)` - stat card wrapped in link
- `healthBadge(health string)` - badge with healthy/warning/issues variants
- `statusDot(enabled bool)` - small colored dot indicator
- `sectionHeader(title, href, viewAllHref string)` - clickable section header with view all

7. **Styling decisions:**
- Use templUI card, badge, button, table components
- Card hover effect: `hover:border-primary/50 transition-colors`
- Failed counts use `text-destructive` when > 0
- Completed counts use `text-green-600 dark:text-green-400`
- Grid responsive: `grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4`
- Section spacing: `space-y-8` between sections

8. **Icons for stat cards:**
- Keep StatIcon helper for document icons
- Add new icons for queue, AI, sources (use existing patterns from sidebar)

9. **Recent activity table in Processing section:**
- Use table.Table() from templUI
- Show 5 most recent jobs
- Columns: Queue, Type, Status (badge), Created
- Reuse jobStatusBadge from queue_dashboard.templ pattern
  </action>
  <verify>
Check `./tmp/air-combined.log` for templ generation errors.
Run: `cat ./tmp/air-combined.log | tail -50`
Visit http://localhost:3000/ to verify dashboard renders.
  </verify>
  <done>
Dashboard template renders with all three sections, stat cards are clickable, health badges show correct status, quick actions are present.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete dashboard with three domain sections (Documents, Processing, Sources), clickable stat cards, health badges, recent activity table, and quick actions.</what-built>
  <how-to-verify>
1. Visit http://localhost:3000/ (the root route)
2. Verify Documents section shows:
   - Total, Processed, Pending, Failed counts
   - Today's uploads count
   - Tag and Correspondent counts
   - Upload quick action button
3. Verify Processing section shows:
   - Health badge (healthy/warning/issues based on queue state)
   - Queue stats (pending, processing, completed, failed)
   - AI pending suggestions count
   - Jobs today count
   - Recent activity table with 5 items
   - Active AI provider name
4. Verify Sources section shows:
   - Inbox total/enabled with status dot
   - Network sources total/enabled with status dot
   - Add Inbox quick action
5. Click stat cards to verify navigation:
   - Total Documents -> /documents
   - Failed jobs -> /queues
   - AI suggestions -> /ai/review
   - Tags -> /tags
6. Verify mobile responsiveness (resize browser)
7. Verify dark mode toggle works
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
1. Dashboard renders without errors at root route
2. All three sections visible with correct data
3. Stat cards navigate to correct pages
4. Health badge reflects actual queue state
5. Recent activity table shows jobs
6. Quick actions work (Upload, Add Inbox)
7. Dark mode styling correct
8. Mobile responsive layout works
</verification>

<success_criteria>
- Dashboard is a functional operations console
- All CONTEXT.md decisions implemented
- Navigation works throughout
- Responsive on all screen sizes
- Dark mode supported
</success_criteria>

<output>
After completion, create `.planning/phases/11-dashboard/11-03-SUMMARY.md`
</output>
