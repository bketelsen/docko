---
phase: 10-templui-refactor
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - templates/layouts/admin.templ
  - templates/layouts/base.templ
autonomous: true

must_haves:
  truths:
    - "Sidebar renders using templUI sidebar component"
    - "Sidebar collapse/expand works correctly"
    - "Navigation links route correctly"
    - "Dark mode toggle still functions"
    - "Mobile menu behavior works"
  artifacts:
    - path: "templates/layouts/admin.templ"
      provides: "Admin layout with templUI sidebar"
      contains: "sidebar.Sidebar"
    - path: "templates/layouts/admin.templ"
      provides: "Sidebar menu items"
      contains: "sidebar.MenuButton"
  key_links:
    - from: "templates/layouts/admin.templ"
      to: "components/sidebar/sidebar.templ"
      via: "import and component usage"
      pattern: 'components/sidebar'
---

<objective>
Refactor the admin layout to use templUI sidebar component

Purpose: Replace the custom AdminSidebar template with templUI's sidebar component for consistent navigation, collapse behavior, and mobile responsiveness out of the box.

Output: Admin layout using templUI sidebar with all navigation items preserved
</objective>

<execution_context>
@/home/bjk/.claude/get-shit-done/workflows/execute-plan.md
@/home/bjk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-templui-refactor/10-CONTEXT.md
@.planning/phases/10-templui-refactor/10-RESEARCH.md

@templates/layouts/admin.templ
@components/sidebar/sidebar.templ
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor AdminSidebar to use templUI sidebar</name>
  <files>templates/layouts/admin.templ</files>
  <action>
Replace the custom `AdminSidebar()` template with templUI sidebar component structure:

1. Add imports for sidebar component and icon component:
   ```go
   import "docko/components/sidebar"
   import "docko/components/icon"
   ```

2. Replace the Admin template layout structure to use `sidebar.Layout()`:
   - Wrap the entire layout in `@sidebar.Layout()`
   - Replace custom `<aside>` with `@sidebar.Sidebar()` component
   - Use `@sidebar.Header()` for the site name
   - Use `@sidebar.Content()` with `@sidebar.Group()` and `@sidebar.Menu()` for navigation
   - Convert each nav link to `@sidebar.MenuItem()` with `@sidebar.MenuButton()`

3. Navigation items to convert (preserve all existing routes):
   - Dashboard (/) - use Home icon
   - Documents (/documents) - use FileText icon
   - Upload (/upload) - use Upload icon
   - Inboxes (/inboxes) - use Inbox icon
   - Network Sources (/network-sources) - use Server icon
   - Tags (/tags) - use Tag icon
   - Correspondents (/correspondents) - use Users icon
   - AI (/ai) - use Sparkles icon (or Brain if available)
   - Queues (/queues) - use Layers icon

4. Keep the sidebar collapsible with icon mode:
   ```go
   @sidebar.Sidebar(sidebar.Props{
       Side:        sidebar.SideLeft,
       Variant:     sidebar.VariantSidebar,
       Collapsible: sidebar.CollapsibleIcon,
   })
   ```

5. Move main content to be a child of `sidebar.Layout()` after the sidebar

6. Preserve the AdminHeader() template but integrate it properly with the layout

7. Add `@sidebar.Script()` at the end of the body for JavaScript functionality

Note: The templUI sidebar handles mobile behavior automatically via sheet component.
  </action>
  <verify>
- Run `make dev` (or check air-combined.log)
- Visit http://localhost:3000 and verify sidebar renders
- Check all navigation links work (Dashboard, Documents, Upload, Inboxes, Network Sources, Tags, Correspondents, AI, Queues)
- Test sidebar collapse/expand behavior
- Verify dark mode toggle still works in header
  </verify>
  <done>
- Admin layout uses templUI sidebar component
- All 9 navigation items render and link correctly
- Sidebar collapse/expand works
- Mobile menu works (test at narrow viewport)
  </done>
</task>

<task type="auto">
  <name>Task 2: Refactor header buttons to use templUI button</name>
  <files>templates/layouts/admin.templ</files>
  <action>
Update AdminHeader() to use templUI button component:

1. Add import for button component:
   ```go
   import "docko/components/button"
   ```

2. Replace the mobile menu button with templUI button:
   ```go
   @button.Button(button.Props{
       Variant: button.VariantGhost,
       Size:    button.SizeIcon,
       Class:   "md:hidden",
       Attributes: templ.Attributes{
           "id": "mobile-menu-btn",
       },
   }) {
       // Menu icon SVG
   }
   ```

3. Replace the theme toggle button with templUI button:
   ```go
   @button.Button(button.Props{
       Variant: button.VariantGhost,
       Size:    button.SizeIcon,
       Attributes: templ.Attributes{
           "id":      "theme-toggle",
           "onclick": "toggleTheme()",
       },
   }) {
       // Sun/moon icons
   }
   ```

4. Replace the logout button with templUI button:
   ```go
   @button.Button(button.Props{
       Variant: button.VariantGhost,
       Size:    button.SizeIcon,
       Type:    button.TypeSubmit,
       Attributes: templ.Attributes{
           "title": "Logout",
       },
   }) {
       // Logout icon SVG
   }
   ```

5. Keep the ThemeToggle script and functionality intact

6. The sidebar trigger for mobile should integrate with templUI sidebar's built-in trigger if possible, otherwise use `@sidebar.Trigger()` component.
  </action>
  <verify>
- Check air-combined.log for compilation
- Visit the app and verify:
  - Theme toggle button works (switches between light/dark)
  - Logout button works (redirects to login)
  - Mobile menu button appears on small screens
  </verify>
  <done>
- Header buttons use templUI button component with Ghost variant
- Theme toggle functionality preserved
- Logout form submission works
- Visual consistency with templUI design system
  </done>
</task>

</tasks>

<verification>
1. Application compiles without errors (check air-combined.log)
2. All navigation routes work correctly
3. Sidebar collapse/expand works
4. Theme toggle works
5. Logout works
6. Mobile responsiveness works (sidebar becomes sheet on mobile)
</verification>

<success_criteria>
- Admin layout uses templUI sidebar component instead of custom aside
- All 9 navigation items present and functional
- Header buttons use templUI button component
- Dark mode toggle still works
- No visual regressions in layout structure
</success_criteria>

<output>
After completion, create `.planning/phases/10-templui-refactor/10-01-SUMMARY.md`
</output>
